{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap ecaf50e8cf2399427d6b","webpack:///./selo.js","webpack:///./helpers.js","webpack:///./polyfill.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,O;ACVA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,uBAAe;AACf;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;;;;;;;;;ACtCA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,EAAC;AACD;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,mEAAkE,sBAAsB;AACxF;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;;AAEA,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA,oBAAmB;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB;AACnB;AACA;AACA;AACA,gBAAe;AACf;AACA;AACA,qBAAoB;AACpB;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA,gBAAe;AACf;AACA;AACA;AACA,mEAAkE;AAClE,kBAAiB;AACjB;AACA;AACA;AACA,iBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA,YAAW;AACX,UAAS;AACT,QAAO;;AAEP;;;AAGA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;;AAEA;;AAEA,iDAAgD;AAChD;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA,IAAG;AACH,IAAG;AACH;AACA;AACA;;;;AAIA,EAAC;;;;;;;;;;;ACjQD;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;ACZA;;AAEA;;AAEA;AACA,gDAA+C;AAC/C;AACA;AACA,4BAA2B;;AAE3B;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP,QAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,4BAA2B;AAC3B;AACA;AACA,MAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAK;AACL;AACA,EAAC;;AAED;AACA;AACA;AACA","file":"selo.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Selo\"] = factory();\n\telse\n\t\troot[\"Selo\"] = factory();\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap ecaf50e8cf2399427d6b","/*\n* 28 August 2016 Abdullah Mara  @abdullah\n*/\n\nvar getParents = require('./helpers')\nvar selectionPolify = require('./polyfill.js')\nselectionPolify.start();\n\n;(function () {\n  function Selo(props) {\n    console.error('SELO START A');\n    if (!props.els) {\n\n        var log = props.log != undefined ? props.log : true\n\n        if (log) {\n          console.log(\"[El parameters] is not defined, this element set as body  \")\n        }\n    }\n\n    if (!document) {\n      throw \"[Platfrom] not supported\"\n    }\n    console.error('iframe 1');\n    if (!props.iframe) {\n       this._document = document;\n    } else {\n       this._document = props.iframe;\n    }\n    if (!props.window) {\n    console.error('iframe 2');\n       this._window = window;\n    } else {\n       this._window = props.window;\n    }\n    console.error('iframe 3');\n\n\n    this._arena      = null;\n    this.selection  = null;\n    console.error('iframe 4');\n    this.els         = props.els || this._document.body;\n    this._bus        = props.bus;\n\n    console.log('in selo...');\n    console.log(this);\n    console.error('iframe 5');\n    this.init()\n  }\n\n  Selo.prototype.init = function () {\n    this._arena = this.els;\n    console.error('window.getSelection????');\n    console.error(this);\n    console.error(this._document);\n    this.selection = this._window.getSelection()\n\n    this.attachEvent();\n  }\n\n  Selo.prototype.attachEvent = function () {\n       console.error('attachEvent...');\n       var selectionEndTimeout = null,\n          endEvent            = new CustomEvent('selectionEnd'),\n          startEvent          = new CustomEvent('selectionStart',{detail:this.selection}),\n          clearEvent          = new CustomEvent('removeSelectionEditor'),\n          beforeStartEvent    = new CustomEvent('selectionBeforeStart');\n\n\n      var map =  {\n        65: false,\n        91: false,\n        37: false,\n        38: false,\n        39: false,\n        40: false,\n        16: false,\n      };\n\n       // \"click\",\n      var listener = [\n        \"mouseup\",\n        \"selectionchange\",\n        \"keyup\",\n        \"keydown\"\n      ].map(function(e) {\n        console.error('addEventListener........');\n        console.error(this);\n        console.error(this._document);\n        this._document.addEventListener(e.toString(), function(evt/*event*/) {\n          console.error(evt);\n          if (evt.type != \"selectionchange\" && evt.type != \"mouseup\") {\n            if (evt.type == \"click\") {\n          \t\tconsole.error('CLICK ON ITEM 01 A dispatch');\n          \t\tconsole.error(evt);\n          \t\t// evt.preventDefault();\n          \t\t// if (evt.target.className == 'close-modal') {\n          \t\t\t// console.error('trgger click');\n          \t\t\t// evt.target.click();\n          \t\t// }\n              // this._document.dispatchEvent(evt);\n\t    } else if (evt.type == \"keydown\") {\n              map[evt.keyCode] = true\n\n            }else{\n\n              if (map[65] && map[91] ) {\n                if (this.hasText()) {\n              \t\t  if (this._bus !== undefined) {\n              \t\t\t     console.error('emit end event 03');\n              \t\t       this._bus.$emit(endEvent.type, endEvent);\n              \t\t  } else {\n                    \t   this._document.dispatchEvent(endEvent);\n              \t\t  }\n                }\n              }\n              else if ((map[16] && map[37]) || (map[16] && map[38]) || (map[16] && map[39]) || (map[16] && map[40]) ) {\n                if (this.hasText()) {\n              \t\t  if (this._bus !== undefined) {\n              \t\t\t   console.error('emit end event 01?');\n              \t\t   \t this._bus.$emit(endEvent.type, endEvent);\n              \t\t  } else {\n                       this._document.dispatchEvent(endEvent);\n              \t\t  }\n                }\n              }else{\n                // Object.keys(map).map(function(e){\n                //   map[e] = false\n                // })\n              }\n            }\n\n          }\n\n          if (evt.type == \"selectionchange\") {\n            // if (this.selection.type == \"Range\") {\n              console.error('selection change A1?');\n              console.error(this.hasText());\n              if (this.hasText()) {\n                  console.error('NICE NICE 99');\n                  console.error(this);\n                  console.error(this._bus);\n            \t\t  if (this._bus !== undefined) {\n            \t\t\t     console.error('emit start event');\n            \t\t  \t   this._bus.$emit(startEvent.type, startEvent);\n            \t\t  } else {\n                       this._document.dispatchEvent(startEvent);\n            \t\t  }\n              } else {\n                console.error('has tetxt aaa');\n                if (this._bus !== undefined) {\n                     console.error('emit end event 02');\n                     this._bus.$emit(clearEvent.type, clearEvent); //only clearEventType is usefull\n                } else {\n                     this._document.dispatchEvent(clearEvent);\n                }\n              }\n            // }else{\n                // if (this.inArena()) {\n                //   document.dispatchEvent(beforeStartEvent);\n                // }\n            // }\n            clearTimeout(selectionEndTimeout);\n          }\n\n          selectionEndTimeout = setTimeout(function(){\n              if (evt.type == \"mouseup\" && this.hasText()) {\n            \t\t  if (this._bus !== undefined) {\n            \t\t\t     console.error('emit endevent mouseup event');\n            \t\t  \t   this._bus.$emit(endEvent.type, endEvent);\n            \t\t  } else {\n                    \tthis._document.dispatchEvent(endEvent);\n            \t\t  }\n              }\n          }.bind(this), 100);\n        }.bind(this))\n      }.bind(this))\n\n    }\n\n\n  Selo.prototype.hasText = function () {\n      if (this.inArena()) {\n        return  this.selection.toString() != \"\"\n      }\n      return false\n    }\n\n    Selo.prototype.inArena = function () {\n      var _arena = this._document.querySelectorAll(this._arena)\n      if (this.selection.focusNode) {\n        var parents = getParents(this.selection.focusNode.parentNode);\n        var tmp = false\n\n        Object.keys(_arena).map(function(e)  {\n          if (parents.indexOf(_arena[e]) != -1) {\n            tmp = true\n          }\n        })\n        return tmp;\n      }\n      return false\n    }\n\n    Selo.prototype.getPositionRange = function () {\n\n      var oRange = this.selection.getRangeAt(0); //get the text range\n      var oRect = oRange.getBoundingClientRect();\n\n      var bound = {};\n\n      bound[\"left\"] =  oRect.left\n      bound[\"top\"] =  oRect.top\n      bound[\"getBoundingClientRect\"] = oRect;\n      return  bound\n    }\n\n    Selo.prototype.saveSelection = function ()  {\n        console.error('save sel test?');\n        if (this._window.getSelection) {\n            var sel = this._window.getSelection();\n            if (sel.getRangeAt && sel.rangeCount) {\n                return sel.getRangeAt(0);\n            }\n        } else if (this._document.selection && this._document.selection.createRange) {\n            return this._document.selection.createRange();\n        }\n        return null;\n    }\n\n    Selo.prototype.restoreSelection  = function (range) {\n        if (range) {\n            if (this._window.getSelection) {\n                var sel = this._window.getSelection();\n                sel.removeAllRanges();\n                sel.addRange(range);\n            } else if (this._document.selection && range.select) {\n                range.select();\n            }\n        }\n    }\n\n\n  if (typeof exports == \"object\") {\n    console.error('export object');\n    module.exports = Selo\n  } else if (typeof define == \"function\" && define.amd) {\n  define([], function () {\n    console.error('return selo');\n    return Selo\n  })\n  } else if (window.Vue) {\n    console.error('return vue solo..');\n    window.Selo = Selo\n  }\n\n\n\n})()\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./selo.js\n// module id = 0\n// module chunks = 0","\nmodule.exports = function getParents(el) {\n  var a = el;\n  var parents = [];\n\n  console.error('GET PARAENTS ... for')\n  console.error(a)\n  while (a) {\n      parents.unshift(a);\n      a = a.parentNode;\n  }\n  return parents;\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./helpers.js\n// module id = 1\n// module chunks = 0","// github.com/2is10/selectionchange-polyfill\n\nvar selectionchange = (function (undefined) {\n\n  var MAC = /^Mac/.test(navigator.platform);\n  var MAC_MOVE_KEYS = [65, 66, 69, 70, 78, 80]; // A, B, E, F, P, N from support.apple.com/en-ie/HT201236\n  var SELECT_ALL_MODIFIER = MAC ? 'metaKey' : 'ctrlKey';\n  var RANGE_PROPS = ['startContainer', 'startOffset', 'endContainer', 'endOffset'];\n  var HAS_OWN_SELECTION = {INPUT: 1, TEXTAREA: 1};\n\n  var ranges;\n\n  return {\n    start: function (doc) {\n      var d = doc || document;\n      if (ranges || !hasNativeSupport(d) && (ranges = newWeakMap())) {\n        if (!ranges.has(d)) {\n          ranges.set(d, getSelectionRange(d));\n          on(d, 'input', onInput);\n          on(d, 'keydown', onKeyDown);\n          on(d, 'mousedown', onMouseDown);\n          on(d, 'mousemove', onMouseMove);\n          on(d, 'mouseup', onMouseUp);\n          on(d.defaultView, 'focus', onFocus);\n        }\n      }\n    },\n    stop: function (doc) {\n      var d = doc || document;\n      if (ranges && ranges.has(d)) {\n        ranges['delete'](d);\n        off(d, 'input', onInput);\n        off(d, 'keydown', onKeyDown);\n        off(d, 'mousedown', onMouseDown);\n        off(d, 'mousemove', onMouseMove);\n        off(d, 'mouseup', onMouseUp);\n        off(d.defaultView, 'focus', onFocus);\n      }\n    }\n  };\n\n  function hasNativeSupport(doc) {\n    var osc = doc.onselectionchange;\n    if (osc !== undefined) {\n      try {\n        doc.onselectionchange = 0;\n        return doc.onselectionchange === null;\n      } catch (e) {\n      } finally {\n        doc.onselectionchange = osc;\n      }\n    }\n    return false;\n  }\n\n  function newWeakMap() {\n    if (typeof WeakMap !== 'undefined') {\n      return new WeakMap();\n    } else {\n      console.error('selectionchange: WeakMap not supported');\n      return null;\n    }\n  }\n\n  function getSelectionRange(doc) {\n    var s = doc.getSelection();\n    return s.rangeCount ? s.getRangeAt(0) : null;\n  }\n\n  function on(el, eventType, handler) {\n    console.error('ONNN AADDD VE ENVET')\n    console.error(el)\n    el.addEventListener(eventType, handler, true);\n  }\n\n  function off(el, eventType, handler) {\n    console.error('OFFF REMOE VE ENVET on..')\n    console.error(el)\n    el.removeEventListener(eventType, handler, true);\n  }\n\n  function onInput(e) {\n    if (!HAS_OWN_SELECTION[e.target.tagName]) {\n      dispatchIfChanged(this, true);\n    }\n  }\n\n  function onKeyDown(e) {\n    var code = e.keyCode;\n    if (code === 65 && e[SELECT_ALL_MODIFIER] && !e.shiftKey && !e.altKey || // Ctrl-A or Cmd-A\n        code >= 35 && code <= 40 || // home, end and arrow key\n        e.ctrlKey && MAC && MAC_MOVE_KEYS.indexOf(code) >= 0) {\n      if (!HAS_OWN_SELECTION[e.target.tagName]) {\n        setTimeout(dispatchIfChanged.bind(null, this), 0);\n      }\n    }\n  }\n\n  function onMouseDown(e) {\n    if (e.button === 0) {\n      on(this, 'mousemove', onMouseMove);\n      setTimeout(dispatchIfChanged.bind(null, this), 0);\n    }\n  }\n\n  function onMouseMove(e) {  // only needed while primary button is down\n    if (e.buttons & 1) {\n      dispatchIfChanged(this);\n    } else {\n      off(this, 'mousemove', onMouseMove);\n    }\n  }\n\n  function onMouseUp(e) {\n    if (e.button === 0) {\n      setTimeout(dispatchIfChanged.bind(null, this), 0);\n    } else {\n      off(this, 'mousemove', onMouseMove);\n    }\n  }\n\n  function onFocus() {\n    setTimeout(dispatchIfChanged.bind(null, this.document), 0);\n  }\n\n  function dispatchIfChanged(doc, force) {\n    var r = getSelectionRange(doc);\n    if (force || !sameRange(r, ranges.get(doc))) {\n      ranges.set(doc, r);\n      setTimeout(doc.dispatchEvent.bind(doc, new Event('selectionchange')), 0);\n    }\n  }\n\n  function sameRange(r1, r2) {\n    return r1 === r2 || r1 && r2 && RANGE_PROPS.every(function (prop) {\n      return r1[prop] === r2[prop];\n    });\n  }\n})();\n\nif (typeof module !== 'undefined') {\n    // CommonJS/Node compatibility.\n    module.exports = selectionchange;\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./polyfill.js\n// module id = 2\n// module chunks = 0"],"sourceRoot":""}